Initialize:
	printflush message1
	set maxUnits 4
	set unitType @flare
	set unitCount 0

GetLinks:
	set switch switch1
	jump GetLinks equal switch null

Start:	
CheckActive:
	sensor active switch @enabled
	jump Bind equal active true

	Disabled:
		set unitCount 0
		set firstUnit null
		jump Start always
	
Bind:
	ubind unitType
	jump NoUnits equal @unit null
	sensor isDead @unit @dead
	jump Start equal isDead true
	jump FinishGroup equal firstUnit @unit
	jump ProcessUnit notEqual firstUnit null

StartGroup:
	set firstUnit @unit

ProcessUnit:
	jump IgnoreUnit greaterThanEq unitCount maxUnits
	 # do stuff with unit
	jump Next always

IgnoreUnit:
	# do stuff with ignored unit

Next:
	op add unitCount unitCount 1
	jump Start notEqual unitCount maxUnits

MaxReached:
	# do stuff when maxed reached
	jump Start always

FinishGroup:
	set unitCount 0
	set firstUnit null
	# do stuff when group is finished
	printflush message1
	jump Start always

NoUnits:
	print "No "
	print unitType
	print "s were found"
	printflush message1
	jump Start always




	


