Initialize:
	set sourceMin 500
	GetLinks:
		set factory factory1
		set unloader unloader1
		set bufferUnloader unloader3
		set buffer container1
		set source nucleus1
		jump GetLinks equal factory null
		jump GetLinks equal unloader null
		jump GetLinks equal bufferUnloader null
		jump GetLinks equal buffer null
		jump GetLinks equal source null
	control enabled unloader false
	control enabled bufferUnloader false
		
Start:
	sensor buildType factory @config
	jump CheckMono equal buildType @mono
	jump CheckFlare equal buildType @flare
	control enabled unloader false
	control enabled bufferUnloader false
	jump Start always
	
CheckFlare:
	sensor facSil factory @silicon
	jump GetSilicon always

CheckMono:	
	sensor facSil factory @silicon
	sensor facLead factory @lead
	op div silLevel facSil 60
	op div leadLevel facLead 30
	jump GetLead lessThan leadLevel silLevel
	
GetSilicon:
	control config bufferUnloader @silicon
	control enabled bufferUnloader true
	jump CheckBuffer always

GetLead:
	control config bufferUnloader @lead
	control enabled bufferUnloader true

CheckBuffer:
	sensor bufferLead buffer @lead
	sensor bufferSil buffer @silicon
	jump FillSiliconBuffer lessThanEq bufferSil 60
	jump FillLeadBuffer lessThanEq bufferLead 30
	control enabled unloader false
	jump Start always

FillSiliconBuffer:
	sensor sourceSil source @silicon
	jump StopSource lessThanEq sourceSil sourceMin	
	control config unloader @silicon
	control enabled unloader true
	jump Start always

FillLeadBuffer:
	sensor sourceLead source @lead
	jump StopSource lessThanEq sourceLead sourceMin
	control config unloader @lead
	control enabled unloader true
	jump Start always

StopSource:
	control enabled unloader false
	jump Start always


