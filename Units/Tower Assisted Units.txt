Initialize:
	set unitType @zenith
	set enemy 1
	set turret 2
	set mode enemy
	
	set shoot true
	set dontShoot false

	GetLinks:
		set switch switch1
		set scout hail1
		jump GetLinks equal switch null
		jump GetLinks equal scout null

	GetUnitStats:
		ubind unitType
		jump GetUnitStats equal @unit null
		sensor range @unit @range
		op sub approachRange range 2
		sensor maxHealth @unit @maxHealth
		
Start:
CheckActive:
	sensor active switch @enabled
	jump BindUnit equal active true
	set enemy null
	jump Start always

BindUnit:
	ubind unitType
	jump Start equal @unit null
	sensor unitDead @unit @dead
	jump Start equal unitDead true
	sensor flag @unit @flag
	jump Start notEqual flag 0
	set currentUnit @unit

CheckHealth:
	sensor health currentUnit @health
	op div healthRatio health maxHealth
	jump Repair lessThan healthRatio 0.5

CheckMode:
	jump FindEnemy equal mode enemy
	jump FindBuilding equal mode turret
	jump Start always

FindBuilding:
	ulocate building turret true 0 targetX targetY found target
	jump ApproachBuilding equal found true
	ulocate building core true 0 targetX targetY found target
	jump ApproachBuilding equal found true

NoTarget:
	ucontrol target false
	ucontrol stop
	jump Start always

ApproachBuilding:
	ucontrol within targetX targetY approachRange isNear
	jump ShootBuilding equal isNear true
	ucontrol approach targetX targetY approachRange
	jump Start always

ShootBuilding:
	ucontrol target targetX targetY shoot
	jump Start always

FindEnemy:
	radar enemy any any distance scout 1 enemy
	jump AttackUnit notEqual enemy null
	uradar enemy ground any distance 0 1 enemy
	jump AttackUnit notEqual enemy null
	uradar enemy any any distance 0 1 enemy
	
AttackUnit:
	jump NoEnemy equal enemy null
	sensor enemyDead enemy @dead
	jump ApproachEnemy equal enemyDead false

NoEnemy:
	set enemy null
	ucontrol targetp null dontShoot
	jump Start always

ApproachEnemy:
	sensor enemyX enemy @x
	sensor enemyY enemy @y
	ucontrol within enemyX enemyY approachRange isNear
	jump ShootEnemy equal isNear true
	ucontrol approach enemyX enemyY approachRange
	jump Start always

ShootEnemy:
	ucontrol targetp enemy shoot
	jump Start always

Repair:
	ucontrol targetp null 0
	ulocate building repair false 0 repairX repairY repairFound repairPoint
	jump Start equal repairFound false
	ucontrol within repairX repairY 5 isNearRepair
	jump Stop equal isNearRepair true
	ucontrol approach repairX repairY 5
	jump Start always

Stop:
	ucontrol targetp null dontShoot
	ucontrol stop
	jump Start always

	

	