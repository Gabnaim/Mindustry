Initialize:
	set unitType @flare
	set maxUnits 4
	
	GetLinks:
		set switch switch1
		jump GetLinks equal switch null

Start:	
CheckActive:
	sensor active switch @enabled
	jump Reset equal active false
	
BindUnit:
	ubind unitType
	jump NoUnits equal @unit null
	sensor isDead @unit @dead
	jump Start equal isDead true

	jump FinishGroup equal firstUnit @unit
	jump ProcessUnit notEqual firstUnit null
	set firstUnit @unit

ProcessUnit:
	jump IgnoreUnit greaterThanEq i maxUnits
	 # do stuff with unit
	jump Next always

IgnoreUnit:
	# do stuff with ignored unit

Next:
	op add i i 1
	jump Start notEqual i maxUnits

MaxReached:
	# do stuff when maxed reached
	jump Start always

FinishGroup:
	set i 0
	set firstUnit null
	# do stuff when group is finished
	printflush message1
	jump Start always

NoUnits:
	print "No "
	print unitType
	print "s were found"
	printflush message1
	jump Start always

Reset:
	set i 0
	set firstUnit null
	jump Start always




	


